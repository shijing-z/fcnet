% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_within.R
\name{calc_within}
\alias{calc_within}
\title{Calculate within-network connectivity}
\usage{
calc_within(conn_array, indices)
}
\arguments{
\item{conn_array}{3D numeric array of connectivity values with dimensions
(ROI x ROI x subjects), as returned by \code{\link{load_matrices}}}

\item{indices}{Named list of integer vectors mapping network names to ROI
index positions, as returned by \code{\link{get_indices}}}
}
\value{
A data frame with one row per subject. Contains one column per
network (named \code{within_{network}}) and a \code{within_network}
column with the average across all networks.
}
\description{
Calculate mean within-network connectivity for each network across all
subjects. For each subject, extracts the upper triangle of each network's
submatrix (excluding diagonal) and averages those values.
}
\details{
Entries in \code{indices} with fewer than 2 ROIs are automatically dropped
with a warning, as within-network connectivity requires at least 2 ROIs
to compute an upper triangle. Use \code{\link{calc_conn}} for single-ROI
connectivity.

Works with any Schaefer version (100-1000 parcels, 7 or 17 networks).
}
\examples{
# Calculate within-network connectivity
indices <- get_indices(example_conn_array, roi_include = "schaefer")
within <- calc_within(example_conn_array, indices)
head(within)

# Select specific network columns
within[, c("within_default", "within_vis")]

\dontrun{
# Full workflow
z_mat <- load_matrices("data/conn.mat", type = "zmat", exclude = c(46, 57))
indices <- get_indices(z_mat, roi_include = "schaefer")
within <- calc_within(z_mat, indices)
}

}
\seealso{
\code{\link{calc_between}} for between-network connectivity.
\code{\link{calc_conn}} for user-defined ROI-to-ROI or ROI-to-network
connectivity.
\code{\link{get_indices}} for generating the \code{indices} input.
}
