% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_heatmap.R
\name{plot_heatmap}
\alias{plot_heatmap}
\title{Plot connectivity matrix heatmap}
\usage{
plot_heatmap(
  conn_array,
  indices,
  subjects = NULL,
  diag = c("blank", "mirror", "lower", "upper"),
  title = NULL
)
}
\arguments{
\item{conn_array}{3D numeric array of connectivity values with dimensions
(ROI x ROI x subjects), as returned by \code{\link{load_matrices}}}

\item{indices}{Named list of integer vectors mapping network names to ROI
index positions, as returned by \code{\link{get_indices}}}

\item{subjects}{Integer or logical vector to subset subjects (third
dimension). Defaults to all subjects. Logical vectors are converted to
integer indices internally}

\item{diag}{Character. Controls diagonal and triangle display. One of:
\itemize{
\item \code{"blank"} (default): set diagonal to NA
\item \code{"mirror"}: show full symmetric matrix
\item \code{"lower"}: show lower triangle only
\item \code{"upper"}: show upper triangle only
}}

\item{title}{Optional character string for the plot title}
}
\value{
A \code{ggplot} object that can be further customized with
standard ggplot2 syntax.
}
\description{
Visualize a group-averaged ROI x ROI connectivity matrix as a heatmap with
network boundary lines and network-level axis labels. Averages across
selected subjects and displays network structure from \code{indices}.
}
\details{
The function averages connectivity values across selected subjects, then
plots the resulting matrix using \code{ggplot2::geom_tile()} with a
diverging color scale centered at zero.

Network boundary lines and axis labels are derived from the \code{indices}
object. ROIs are reordered to match the network ordering in \code{indices},
so the heatmap reflects any reordering applied by \code{\link{get_indices}}.

Which ROIs appear in the heatmap is controlled by \code{indices}. Use
\code{roi_include = "schaefer"} in \code{\link{get_indices}} to exclude
non-Schaefer ROIs, or \code{roi_include = "all"} to include them as
additional blocks with their own boundaries and labels.

Works with any Schaefer version (100-1000 parcels, 7 or 17 networks).
}
\examples{
# Basic heatmap of all subjects
indices <- get_indices(ex_conn_array)
plot_heatmap(ex_conn_array, indices)

# Subset subjects by index
plot_heatmap(ex_conn_array, indices, subjects = 1:5)

# Subset with logical vector
plot_heatmap(ex_conn_array, indices, subjects = c(rep(TRUE, 5), rep(FALSE, 5)))

# Lower triangle only
plot_heatmap(ex_conn_array, indices, diag = "lower", title = "Lower Triangle")

# Schaefer-only heatmap (exclude non-Schaefer ROIs)
indices_sch <- get_indices(ex_conn_array, roi_include = "schaefer")
plot_heatmap(ex_conn_array, indices_sch)

\dontrun{
# Group comparison workflow
z_mat <- load_matrices("data/conn.mat", type = "zmat", exclude = c(46, 57))
indices <- get_indices(z_mat)

# Young adults
plot_heatmap(z_mat, indices, subjects = 1:41, title = "Young Adults")

# Older adults using logical vector from demographics
plot_heatmap(z_mat, indices, subjects = demo$group == "OA",
             title = "Older Adults")
}

}
\seealso{
\code{\link{get_indices}} for generating the \code{indices} input.
\code{\link{load_matrices}} for loading connectivity data.
}
